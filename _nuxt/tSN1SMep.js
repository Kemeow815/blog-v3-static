import{an as k,ao as R,ap as x,J as G,aq as Q,a4 as i,ar as W,w as _}from"#entry";function D(s){return k()?(R(s),!0):!1}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const p=new WeakMap;function O(s,c,m={}){const{mode:g="replace",route:f=x(),router:n=G(),transform:r}=m;let u=e=>e,l=e=>e;typeof r=="function"?u=r:r&&(r.get&&(u=r.get),r.set&&(l=r.set)),p.has(n)||p.set(n,new Map);const a=p.get(n);let t=f.query[s];D(()=>{t=void 0});let y;const h=Q((e,q)=>(y=q,{get(){return e(),u(t!==void 0?t:i(c))},set(o){o=l(o),t!==o&&(t=o===i(c)?void 0:o,a.set(s,o===i(c)?void 0:o),q(),W(()=>{if(a.size===0)return;const S=Object.fromEntries(a.entries());a.clear();const{params:d,query:w,hash:b}=f;n[i(g)]({params:d,query:{...w,...S},hash:b})}))}}));return _(()=>f.query[s],e=>{t!==u(e)&&(t=e,y())},{flush:"sync"}),h}export{O as u};
